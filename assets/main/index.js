window.__require=function e(t,r,i){function o(s,n){if(!r[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!n&&l)return l(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var d=r[s]={exports:{}};t[s][0].call(d.exports,function(e){return o(t[s][1][e]||e)},d,d.exports,e,t,r,i)}return r[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<i.length;s++)o(i[s]);return o}({NumberPrefab:[function(e,t){"use strict";cc._RF.push(t,"595d8M5C8BGM4VWR1pig961","NumberPrefab"),cc.Class({extends:cc.Component,properties:{spriteframe:[cc.SpriteFrame]},start:function(){}}),cc._RF.pop()},{}],WetermelonPrefab:[function(e,t){"use strict";cc._RF.push(t,"21751hH5SdN+qxmpJTm9JGt","WetermelonPrefab"),cc.Class({extends:cc.Component,properties:{spriteframe:[cc.SpriteFrame],type:cc.Number,PrefabWatermelon:cc.Prefab,BoomFrame:[cc.SpriteFrame]},onLoad:function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,this.changeType(window.WETERMELON_TYPE)},start:function(){},changeType:function(e){this.type=e>10?10:e,e=this.type,console.log("\u6362\u56fe\uff01\uff01"),this.sprite=this.node.getComponent(cc.Sprite),this.sprite.spriteFrame=this.spriteframe[e],this.physicsCircleCollider=this.node.getComponent(cc.PhysicsCircleCollider),this.circleCollider=this.node.getComponent(cc.CircleCollider),this.circleCollider.tag=e-1,0==e?(this.physicsCircleCollider.radius=27,this.circleCollider.radius=32):1==e?(this.physicsCircleCollider.radius=40,this.circleCollider.radius=45):2==e?(this.physicsCircleCollider.radius=55,this.circleCollider.radius=60):3==e?(this.physicsCircleCollider.radius=61,this.circleCollider.radius=66):4==e?(this.physicsCircleCollider.radius=77,this.circleCollider.radius=82):5==e?(this.physicsCircleCollider.radius=93,this.circleCollider.radius=98):6==e?(this.physicsCircleCollider.radius=94,this.circleCollider.radius=99):7==e?(this.physicsCircleCollider.radius=130,this.circleCollider.radius=135):8==e?(this.physicsCircleCollider.radius=155,this.circleCollider.radius=160):9==e?(this.physicsCircleCollider.radius=152,this.circleCollider.radius=157):10==e&&(this.physicsCircleCollider.radius=203,this.circleCollider.radius=208),this.node.getComponent(cc.PhysicsCircleCollider).apply()},onCollisionEnter:function(e,t){if(e.tag==t.tag&&10!=e.tag){if(!(t.node.y<e.node.y))return void this.node.destroy();console.log("\u78b0\u649e",e.tag),e.node.destroy(),this.watermelonBoom(t.tag+1)}},onCollisionStay:function(e,t){if(e.tag==t.tag&&10!=e.tag){if(!(t.node.y<e.node.y))return void this.node.destroy();e.node.destroy(),this.watermelonBoom(t.tag+1)}},watermelonBoom:function(e){this.node.getComponent(cc.AudioSource).play(),this.sprite=this.node.getComponent(cc.Sprite),this.sprite.spriteFrame=this.BoomFrame[e],this.physicsCircleCollider=this.node.getComponent(cc.PhysicsCircleCollider),this.circleCollider=this.node.getComponent(cc.CircleCollider),this.circleCollider.tag=e,this.node.getComponent(cc.PhysicsCircleCollider).apply(),this.scheduleOnce(function(){this.changeType(e+1),window.SCORE+=2*(e+1),console.log("\u5f97\u5206",window.SCORE)},.2)},deathGame:function(){(null==cc.sys.localStorage.getItem("score")||cc.sys.localStorage.getItem("score")<window.SCORE)&&cc.sys.localStorage.setItem("scoew",window.SCORE)}}),cc._RF.pop()},{}],config:[function(e,t){"use strict";cc._RF.push(t,"b3e5cAtKC1Ko5d/I10JdI0d","config"),t.exports={SERVER_URL:"http://127.0.0.1:5000"},cc._RF.pop()},{}],death:[function(e,t){"use strict";cc._RF.push(t,"bba47YRMrVPVafh+33Bkbrh","death");var r,i=(r=e("./config"))&&r.__esModule?r:{default:r};cc.Class({extends:cc.Component,properties:{DeathNode:cc.Node,Backgarournd:cc.Node},onLoad:function(){cc.director.getPhysicsManager().enabled=!0},start:function(){},onCollisionStay:function(){this.isDead||(this.collisionStartTime?Date.now()-this.collisionStartTime>=2e3&&(console.log("\u6b7b\u4ea1"),this.isDead=!0,this.uploadScore("player1",window.SCORE),this.DeathNode.setPosition(cc.v2(0,0)),this.Backgarournd.off("touchstart",this.WatermelonDown,this),this.collisionStartTime=null):this.collisionStartTime=Date.now())},onCollisionExit:function(){this.collisionStartTime=null},uploadScore:function(e,t){var r=new XMLHttpRequest;r.open("POST",i.default+"/add_score",!0),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.onreadystatechange=function(){4===r.readyState&&200===r.status?console.log("Score uploaded successfully:",r.responseText):4===r.readyState&&console.error("Error uploading score:",r.statusText)};var o=JSON.stringify({player_id:window.user_id,score:t});r.send(o)}}),cc._RF.pop()},{"./config":"config"}],game:[function(e,t){"use strict";cc._RF.push(t,"c5236QgPTNMCoC8ejimk3LN","game"),cc.Class({extends:cc.Component,properties:{PrefabWatermelon:cc.Prefab,typeNode:cc.Node,spriteframe:[cc.SpriteFrame]},onLoad:function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-1e3),cc.director.getCollisionManager().enabled=!0,this.node.on("touchstart",this.WatermelonDown,this),this.IsWatermelonDown=!0,window.BACKGROUND_NODE=this.node},start:function(){},onDestroy:function(){this.node.off("touchstart",this.WatermelonDown,this)},WatermelonDown:function(e){if(this.IsWatermelonDown){console.log("\u70b9\u51fb"),this.IsWatermelonDown=!1,this.scheduleOnce(function(){this.IsWatermelonDown=!0},1);var t=cc.instantiate(this.PrefabWatermelon),r=e.getLocationX()-360;this.circleCollider=t.getComponent(cc.CircleCollider);var i=490-2*this.circleCollider.radius;t.setPosition(cc.v2(r,i)),this.node.addChild(t),window.WETERMELON_ARRAY.push(t),window.WETERMELON_TYPE=Math.floor(5*Math.random()),this.sprite=this.typeNode.getComponent(cc.Sprite),this.sprite.spriteFrame=this.spriteframe[window.WETERMELON_TYPE]}},goMainWindow:function(){window.SCORE=0,window.WETERMELON_TYPE=0,cc.director.loadScene("main_scene")},againGame:function(){window.SCORE=0,window.WETERMELON_TYPE=0}}),cc._RF.pop()},{}],main:[function(e,t){"use strict";cc._RF.push(t,"b9467PEcvROIp0lo0hllfoS","main"),cc.Class({extends:cc.Component,onLoad:function(){},start:function(){if("undefined"!=typeof Telegram&&Telegram.WebApp){Telegram.WebApp.ready(),console.log("Telegram WebApp is ready"),window.user_id=Telegram.WebApp.initDataUnsafe.user.id;var e=cc.find("Canvas/bg/Label");if(e){var t=e.getComponent(cc.Label);t?t.string=window.user_id:console.error("\u672a\u627e\u5230 Label \u7ec4\u4ef6")}else console.error("\u672a\u627e\u5230 Label \u8282\u70b9")}},connectTg:function(){try{var e=cc.find("Canvas/bg/tg/Lable");if(e&&(e.getComponent(cc.Label).string=11111111111),Telegram.WebApp.ready(),console.log("Telegram WebApp is ready"),window.user_id=Telegram.WebApp.initDataUnsafe.user.id,!e)throw new Error("\u672a\u627e\u5230 Label \u8282\u70b9");var t=e.getComponent(cc.Label);if(!t)throw new Error("\u672a\u627e\u5230 Label \u7ec4\u4ef6");t.string=window.user_id}catch(o){console.error(o.message);var r=cc.find("Canvas/bg/tg/Lable");if(r){var i=r.getComponent(cc.Label);i&&(i.string=o.message)}}},startGame:function(){cc.director.loadScene("game_scene")},exitGame:function(){cc.game.end()}}),cc._RF.pop()},{}],maxScore:[function(e,t){"use strict";cc._RF.push(t,"6f5cem0KQ1O2IUK7B7m9Q+O","maxScore");var r=e("./config").SERVER_URL;cc.Class({extends:cc.Component,properties:{NumberPrefab:cc.Prefab,Numberframe:[cc.SpriteFrame]},start:function(){var e=window.user_id;console.log("Fetching score for player:",e),this.fetchScore(e)},fetchScore:function(e){var t=new XMLHttpRequest;t.open("GET",r+"/get_score/"+e,!0),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var e=JSON.parse(t.responseText);console.log("Received data:",e),void 0!==e.score?this.setScorenumber(e.score):console.error(e.error)}else 4===t.readyState&&console.error("Error:",t.statusText)}.bind(this),t.send()},setScorenumber:function(e){this.node.removeAllChildren(),this.numberArray=[];var t=Math.floor(e);console.log(t);do{var r=cc.instantiate(this.NumberPrefab);r.getComponent(cc.Sprite).spriteFrame=this.Numberframe[Math.floor(t%10)],this.numberArray.push(r),t=Math.floor(t/10)}while(t>0);this.numberArray.reverse();for(var i=0;i<this.numberArray.length;i++)this.numberArray[i].setPosition(cc.v2(42*i,0)),this.node.addChild(this.numberArray[i])}}),cc._RF.pop()},{"./config":"config"}],score:[function(e,t){"use strict";cc._RF.push(t,"3d4c0cc0t9Ls7DRFrVFvKbo","score"),cc.Class({extends:cc.Component,properties:{NumberPrefab:cc.Prefab,Numberframe:[cc.SpriteFrame]},onLoad:function(){this.updataScore()},start:function(){},updataScore:function(){this.mytime=setInterval(this.setScorenumber.bind(this),1e3)},onDestroy:function(){clearInterval(this.mytime)},setScorenumber:function(){this.node.removeAllChildren(),this.numberArray=[];var e=Math.floor(window.SCORE);console.log(e);do{var t=cc.instantiate(this.NumberPrefab);t.getComponent(cc.Sprite).spriteFrame=this.Numberframe[Math.floor(e%10)],this.numberArray.push(t),e=Math.floor(e/10)}while(e>0);this.numberArray.reverse();for(var r=0;r<this.numberArray.length;r++)this.numberArray[r].setPosition(cc.v2(42*r,0)),this.node.addChild(this.numberArray[r])}}),cc._RF.pop()},{}]},{},["NumberPrefab","WetermelonPrefab","config","death","game","main","maxScore","score"]);